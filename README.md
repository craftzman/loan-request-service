# Loan Request Service
Demo Spring-boot REST API for code challenge
## Requirement
* Java version 17.x.x or higher
## Installation
Use maven to build, install and run
### Install
```bash
mvn clean install
```
### Run
```bash
mvn spring-boot:run
```
### Run from Jar file
#### Jar file usage
After executing maven build command, the jar file can be found under
```
<location>/loan-request-service/target/
```
Copy to location you desire or just run it directly from target folder
```bash
java -jar loan-request-service-0.0.1-SNAPSHOT.jar
```
#### Usage

* After the project started the main url is [loan-request-service](http://localhost:8080)

* Project also provides [swagger page](http://localhost:8080/api/swagger-ui/index.html) here

* If running project from IDE H2 database admin page also available [here](http://localhost:8080/h2-console)
  - user = sa with no password

### APIs
* [create loan](http://localhost:8080/v1/loans)
  - To create a new loan this information is required
    - a customer id `Long`
    - full name `String`
    - list of loan amount `List<Double>`
    
  loan id is mandatory but will be generated by the system, 
  user don't need to add them manually. 
  - If new loan request has the same customer id that already in the system
  but different customer full name, the new loan request can not be created.
  User has to check with another [API](http://localhost:8080/v1/loans/customers/{customerId}/full-name) 
  by providing customer id to get customer full name and use it to create new loan request for existing customer
* [calculate loan](http://localhost:8080/v1/loans/{customerId}/total-loan)
  - To calculate total loan amount of a particular customer, 
  if customer id doesn't exist an exception is thrown. 
* [find customer full name](http://localhost:8080/v1/loans/customers/{customerId}/full-name)
  - In case for adding loan request to exiting customer
  the customer's full name must be the same otherwise an exception will be thrown.
  This api can provide customer's full name by request with customer id. 

### Solution Decision
* H2 database is used due to easy for setup and pack to run within jar file
* Loan-Request table has 4 fields 
  - loan id `auto-generated id`
  - loan amount
  - customer id `index`
  - customer full name
  
  As main activity is getting total loan amount of each customer,
  so having index on customer id can improve performance on calculating amount
  of each customer.

  It might not be the best way but easier and safer than create a new look-up
  table that has just `customer id` and `total loan amount` and everytime 
  that customer id has any update this `total loan amount` will be recalculated
  which at least need a `transaction` for updating 2 tables and might cause data
  integrity if look-up table failed while updating.

  In normal situation each customer might not have too many loan records that 
  can cause database indexing a performance issue.
* Package organization is not separated by layer as 
  - service
  - controller
  - persistence
  
  But group into one domain as loan request domain and split into just service and web instead.
  According to an article I have read, grouping by layer lean toward monolith style rather than micro-services. 
